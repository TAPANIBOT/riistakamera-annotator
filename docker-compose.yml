services:
  wildlife-detector:
    build: .
    container_name: wildlife-detector
    restart: unless-stopped
    ports:
      - "0.0.0.0:5000:5000"
    volumes:
      - wildlife-data:/data
    environment:
      - DATA_DIR=/data
      - IMAGE_DIR=/data/images/incoming
      - ANNOTATION_DIR=/data/annotations
      - PREDICTION_DIR=/data/predictions
      - GMAIL_USER=tapani@skyplanner.ai
      - FETCH_INTERVAL_SECONDS=1800
    secrets:
      - gmail_app_password
    networks:
      - agent-network
    mem_limit: 6g
    cpus: 2.0

secrets:
  gmail_app_password:
    file: ${HOME}/secrets/gmail-agent_secrets.yaml

volumes:
  wildlife-data:
    driver: local

networks:
  agent-network:
    external: true
